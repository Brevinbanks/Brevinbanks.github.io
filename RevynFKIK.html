<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!--CSS Styles -->
    <link rel="stylesheet" href="assets/css/styles.css" />

    <!-- Favicons -->
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="assets/icons/apple-touch-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="assets/icons/favicon-32x32.png"
    />

    <!-- Animate CSS CDN -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
    <title>Brevin Banks | Revyn FK&IK</title>
    

    <style>
    div.backhead {
      padding: 1.1rem;
      background-image: url(page-Revynline.png);
      background-repeat: no-repeat;
      /* background-attachment: fixed; */
      text-shadow: -1px 1px #000000;
      background-size: cover;
    }

    div.backblank {

      padding: 1rem;
      background-color: rgb(255, 255, 255);
      background-repeat: no-repeat;
      /* background-attachment: fixed; */
      
    
      background-size: cover;
    }


    </style>
    

  </head>

  <body>
    <!-- Navbar -->
    <nav>
      <h1>Brevin Banks </h1>
      <ul class="navigation">
        <li><a href="./index.html" class="nav-link">Home</a></li>
        <li><a href="#description" class="nav-link">Description</a></li>
        <li><a href="#FK" class="nav-link">FK</a></li>
        <li><a href="#IK" class="nav-link">IK</a></li>
        <li><a href="#Traj" class="nav-link">Trajectory</a></li>
        <li><a href="./index.html#contact" class="nav-link">Contact</a></li>
        <li><a href="./more.html">More</a></li>
      </ul>
      <button class="burger-menu" id="burger-menu">
        <ion-icon class="bars" name="menu-outline"></ion-icon>
        <!-- <ion-icon class="times" name="close-outline"></ion-icon> -->
      </button>
    </nav>
    
    <div class="backhead">
      <h2 style="color:white;">6 DOF Robot Arm Forward & Inverse Kinematics: The Revyn Arm </h2>
    </div>

    <div class="backblank">

    </div>


    <!-- More about -->
    
    <!-- More about -->
    <section class="basicparagraphrightim" id="description">
      <h2>Project Description</h2>
        <p>
          This project is a continuation of the <a href="./RevynDesign.html">Revyn Arm design project</a>. Here 
          I will be exploring basic robotics and control using forward kinematics (FK) and inverse kinematics (IK).
          The goal is to understand how the robot end effector moves and responds relative to the base of the robot.
          I will continue to keep the same requirements from design phase of the project to have the robot move
          accurately and compatible with serial commands. However, I am aware how the servo torque may not be 
          strong enough to ensure the robot can cover all of the joint space, and a new limitation here is that the joints
          can only move 90&deg forward and backward from their home configurations. This means that in our
          geometric solutions to FK and IK the robot can only achieve positions so long as all the joints are within
          +/- 90&deg.
       <figure>
         <img 
         src="assets/images/6DofRobotArmHalfPose4.jpg"
         height= "auto"
         alt="Rendering of revyn arm"
         loading="lazy"
         class="basicparagraphrightim-img"
         />
         <figcaption>Fig.1 Revyn Arm Hardware Design.</figcaption>
       </figure>
      
      </p>
    </section>
    <section class="basicparagraphleftim" id="FK">
      <h2>Forward Kinematics</h2>
      <p>
      Forward kinematics is the process of interpreting physical constraints for a rigid body 
      and how free variables between rigid bodys affect their geometric positions in 3D space.
      In this case, we have 6 joints meaning we have 6 free angle variables (&theta;<sub>1</sub>,&theta;<sub>2</sub>,&theta;<sub>3</sub>,&theta;<sub>4</sub>,&theta;<sub>5</sub>,&theta;<sub>6</sub>) that determine what the
      final position and orientation of the end effector will be relative to the base of the robot. 
      We will construct a relationship between the base and end effector using these variables. 
      The method I will be using utilizes <a href="https://en.wikipedia.org/wiki/Moving_frame" target="_blank">Homogeneous Frame transformations</a>
       and <a href="https://en.wikipedia.org/wiki/Denavit%E2%80%93Hartenberg_parameters" target="_blank">DH parameters</a>.
        <br><br>
        To briefly summarize what this all means: we will create a frame at all 6 joints and at the base and at the end effector. 
        A frame is an object that holds position information and orientation information. We identify frames by using the 
        fixed lengths of the robot arms up to the frame position and identifying that position by using the joint variables assigned
        to the joints up to the joint of interest.
        When we use DH paramters to help find these frames, we have a set of rules on how these frames are likely
        to be positioned relative to each other. In short, we will always have the frame's Z axis pointing along the axis of rotation
        for the respective joint. When we move from frame to frame along the robot, we only ever rotate or translate about Z
        or X. Never Y. This is not always necessary, but in my opinion this makes the determination of the FK and IK easier in the future. 
        It's not critical to understand all of these details, but if you follow along it will help you see why we make certain decisions.
        <br>
      </p>
        <div>
          <figure>
            <img 
            src="assets/images/DHRevyn.jpg"
            height= "auto"
            alt="Revyn Arm with DH paramters"
            loading="lazy"
            class="basicparagraphleftim-img"
            />
            <figcaption>Fig.2 Revyn Arm with DH parameters.</figcaption>
          </figure>  
        </div>
        <p>
        We might define the relative 0&deg; positions of the joints as we see in figure 2. The frames follow the pattern 
        with x axis-red, y axis-green, and z axis-blue. We will say that
        all the joints can move +/- 90&deg; except for joint 3 which can move between [0,180]&deg;.
        The lengths of the joints on the robot are as follows as seen in figure 2: d1 = 88.95mm a2 = 53.86mm d4 = 142.18mm d6=201.88mm
        <br>
        To start we draw the frames where they should lie on the robot and collect the DH parameters to make those frames possible.

  </p>
    <br>
  </section>
   
    <div>

    <table style="border:1px solid black;margin-left:auto;margin-right:auto; padding: 0.5rem">
      <tr>
        <td><b>Joint n to Joint m</b></td>
        <td><b>Z rot (&theta;)</b></td>
        <td><b>Z trans (d)</b></td>
        <td><b>X trans (a)</b></td>
        <td><b>X rot (&alpha;)</b></td>
      </tr>
      <tr>
        <td>Base (0) to Joint 1</td>
        <td>&theta;<sub>1</sub></td>
        <td>d1</td>
        <td>0</td>
        <td>0</td>
      </tr>
        <tr>
          <td>Joint 1 to Joint 2</td>
        <td>&theta;<sub>2</sub></td>
        <td>0</td>
        <td>0</td>
        <td>pi/2</td>
      </tr>
    </tr>
    <tr>
      <td>Joint 2 to Joint 3</td>
    <td>pi/2, &theta;<sub>3</sub></td>
    <td>0</td>
    <td>a2</td>
    <td>0</td>
  </tr>
</tr>
<tr>
  <td>Joint 3 to Joint 4</td>
<td>&theta;<sub>4</sub></td>
<td>0</td>
<td>0</td>
<td>pi/2</td>
</tr>
<tr>
  <td>Joint 4 to Joint 5</td>
  <td>&theta;<sub>5</sub></td>
  <td>d4</td>
  <td>0</td>
  <td>-pi/2</td>
  </tr>
  <tr>
    <td>Joint 5 to Joint 6</td>
    <td>&theta;<sub>6</sub></td>
    <td>0</td>
    <td>0</td>
    <td>pi/2</td>
    </tr>
    <tr>
      <td>Joint 6 to EF</td>
      <td>0</td>
      <td>d6</td>
      <td>0</td>
      <td>0</td>
      </tr>
    </table>   
  </div>

  <section class="basicparagraphleftim">
    <div>
    <p>The resultant symbolic forward kinematics result can be found in <a href="https://github.com/Brevinbanks/RevynArm/blob/main/FK_Revyn.m" target="_blank">FK_Revyn.m</a> and
      MATLAB derivation is found in <a href="https://github.com/Brevinbanks/RevynArm/commit/84a1aabc80e9250c90c28b50c9f23b9a0da7ff20" target="_blank">Fk derivation.</a> 
     </p>
    </div>
  </section>
  
  
  
    <section class="basicparagraphleftim" id="IK">



    <div>
      <h2>Inverse Kinematics</h2>
      
      <p>
Inverse kinematics is similar to forward kinematics in that we want to describe the position and orientation of the end effector in 3D space.
However with inverse kinematics, we have the end effector's position and orientation, but not the specific joint angles of the robot require to achieve them.
Identifying the correct joint angles is a difficult problem, and often times there is either no solution or an infinite amount of solutions.
In my approach to inverse kinematics we will address finding the most simple first solution returned by my algorithm.
We will assume that there are 6 unknowns (the six joint variables), and 6 knowns (position x,y, and z, and orientation in <a href="https://en.wikipedia.org/wiki/Euler_angles" target="_blank">Euler ZYZ rotation form</a>)
         </p>
         <p>
          The actual derivation of the inverse kinematics is quite lengthy, and many researchers have identified
          the solution to this problem in their works with similarly shaped robots. My solution uses the same ideas and formulas.
          For the derivation of my inverse kinematics see <a href="https://github.com/Brevinbanks/RevynArm/commit/84a1aabc80e9250c90c28b50c9f23b9a0da7ff20" target="_blank">Ik derivation.</a>
          For the complete IK function see <a href="https://github.com/Brevinbanks/RevynArm/blob/main/IK_Revyn.m" target="_blank">IK_Revyn.m</a>
        </p>
        <p> The IK_Revyn function accepts a Homogenous frame transform describing the end effector relative to the base.
          Then it breaks the frame into a position vector and 3 ZYZ euler angles. We start the inverse operation with joint 1.
          Joint 1 is found by using the law of cosines between the position of the base and the point of joint 5. The point of
          joint 5 is found first by assuming the orignal orientation of the given Homogenous frame has the same orientation of the 
          frame and frame 6. With this assumption the position at frame 6 is just d6 back in the orientation of the given frame.
          With joint 1 obtained we can find joints 2 and 3 using the law of cosines in a similar manner to the position of frame 6 at joint 5.
          There are many conditions to observe in order to ensure our calculations with acos or atan2 return the angle in the correct
          quadrant. See the code for these conditions.
  
        </p>
        <p></p>
      </div>
      </section>

      <section class="basicparagraphrightim" id="cadexplain">
      <div>
      <figure>
        <img 
        src="assets/images/RevynLimbHomeRenderHalfsize.png"
        height= "auto"
        alt="Revyn Arm with frame at base, Z is up, X towards the reader, and Y to the right"
        loading="lazy"
        class="basicparagraphrightim-img"
        />
        <figcaption>Fig.3 Revyn Arm at home pose with frame.</figcaption>
      </figure>

      <p>
        There ended up being 6 custom parts modeled and printed for the robot. There is the base, the base cup, joint 2, joint 3, joint 4, and joint 5.
        The base cup could be interpreted as joint 1 as it is directly attached to the first servo. The second and third joints in the model are refered
        to as short joints because the first design featured both of these joints being an inch longer than in the final product.
        The MG996R servos used to build this robot were a little on the cheaper side, and could not supply enough torque to lift
        the robot without some help when the arm was too long. I shortened the lengths of joints 2 and 3 to get the robot to perform a little bit better.
        We'll address how this issue comes into play again later. The following video shows the completed Revyn Arm model with an exploded view and
        the 180&deg functionality of each joint.
      </p>

      <video  width="100%" height="100%"  autoplay muted loop>
        <source src="https://media.githubusercontent.com/media/Brevinbanks/Brevinbanks.github.io/main/assets/videos/CroppedRevynLimb.mp4" type="video/mp4" />
       </video>
      </div>
    </section>

    <section class="basicparagraphleftim" id="Schematics">
    <div>
      <h2 align="center">Schematics</h2>
      <p>
      With the hardware designed, it was time for the electronics. As mentioned previously 
      I used an Arduino Mega 2560 and PCA9685 to control the robot. The Arduino was used to recieve
      serial commands and interpret them as signals to send to the PCA9685. The PCA9685 is a servo 
      motor driver that can control many servos at once. For this project I was controlling 7 low power
      servos so it seemed like a good fit. I was running the control loop for these serial commands at 
      9600 Baud and a control loop rate of 60Hz for the servos. I used an external bench top power supply (not factored
      into the cost of the project) to supply 6 Volts to the PCA9685 V+ pin to power the servos. I did not use
      the given PCA9685 power terminal block to power the servos. For whatever reason the PCA9685 chips
      I purchased did not have the terminal pins wired correctly and was not supplying power. The work around
      was just to use the V+ pin, typically used for powering other PCA9685 boards when chained together. The arduino
      was powered by the computer sending serial commands. See the following schematic for wiring details.
     </p>

     <img src = "assets/images/RevynSchematic_bb.svg" alt="Schematic of the Arduino and PCA9685 wiring for the Revyn Arm"/>
     <p>
     The CAD model and electronic schematics were completed and the physical hardware was printed and assembled. 
     The total cost of materials came down to around only $140. This included a $20 roll of PLA, the Arduino, PCA9685, the wires
     , some hardware to hold the parts together, the servos, and the end effector claw. I was surprised at how much
     cheaper I was able to assemble the arm for, but I have observed that these inexpensive parts have their draw backs.
     The servos are not as strong as I'd like and they have a smaller holding torque than expected. The arm struggles to reach 
     some of the areas within the arm's joint space.
    </p>
    <p>
     In order to determine what the servos could feasibly do, I had to calibrate them. I wanted to be
     able to send an angle command to the arduino and have the servos move accodingly, but in order to 
     use the PCA9685 with the necessary Adafruit library the servos require PWM values. For each 
     servo I assigned a PWM value and measured how the angle changed with an offhand protractor I had.
     Possibly not the best solution, but after I got 20 or so points for each joint I figured it would be within
     a few centimeters of accuracy as I was hoping. I ran a linear regression for each servo's Angle to PWM datasets
     and found a good fitting calibration. With the calibration complete I was able to make my control script, <a href="https://github.com/Brevinbanks/RevynArm/blob/main/RevynMat2ArdController.ino" target="_blank">RevynMat2ArdController.ino</a>.
    With this script I tried to drive the servos within different ranges to see where they would fail or where they 
    could supply the necessary torque. You will see in the future forward kinmetics and inverse kinematics
    project how this plays out.
    </p>
  </div>
<div>
    <p>
      For now we can appreciate how the finished hardware product came together!

    </p>
  </div>
  </section>

  <section class="dispafewimg">
      <img 
      src="assets/images/6DofRobotArmHalf.jpg"
      alt="Revyn Arm with frame at base, Z is up, X towards the reader, and Y to the right"
      loading="lazy"

      class="dispafewimg"/>

      <img 
      src="assets/images/6DofRobotArmHalfPose1.jpg"
      alt="Revyn Arm with frame at base, Z is up, X towards the reader, and Y to the right"
      loading="lazy"

      class="dispafewimg"/>

      <img 
      src="assets/images/6DofRobotArmHalfPose3.jpg"
      alt="Revyn Arm with frame at base, Z is up, X towards the reader, and Y to the right"
      loading="lazy"

      class="dispafewimg"/>
    
    </section>

      
    <section class="basicparagraphleftim" id="Resources">
      <h2 align="center">Resources</h2>
      <p>
        All source code for this project can be found on <a href="https://github.com/Brevinbanks/RevynArm/tree/main" target="_blank">my github page</a>.
      
        The step CAD files for the parts can be found <a href="https://github.com/Brevinbanks/Brevinbanks.github.io/tree/main/assets/Modeled%20Parts" target="_blank">here</a>.
        A completed assembly file is also <a href="https://github.com/Brevinbanks/Brevinbanks.github.io/tree/main/assets/Assembly" target="_blank">here</a>.
        
        A <a href="https://github.com/Brevinbanks/Brevinbanks.github.io/tree/main/assets/Drawings" target="_blank">drawing</a> packet with a bill of materials, should someone else want to build the robot, is listed below.

      </p>

        <object data="assets/Drawings/RevynV1DrawingPacket.pdf" type="application/pdf" width="100%" height="500px">
        <p>Unable to display drawing packet PDF file. <a href="assets/Drawings/RevynV1DrawingPacket.pdf">Download</a> instead.</p>
      </object>
    </section>

      <!-- <video  width="500px" height="500px" controls autoplay muted loop>
        <source src="https://media.githubusercontent.com/media/Brevinbanks/Brevinbanks.github.io/main/assets/videos/FKMergedProving.mp4" type="video/mp4" />
       </video> -->


    <!-- Projects section -->
    <section class="projects" id="projects">
      <h2 class="projects-title">Some of my Recent Projects</h2>
      <div class="projects-container">
        <div class="project-container project-card">
          <img
            src="assets/images/6DofRobotArm3.png"
            alt="6DOF Robot Arm"
            loading="lazy"
            class="project-pic"
          />
          <h3 class="project-title">6DOF Linear Trajectory, IK, & FK</h3>
          <p class="project-details">
            Linear Trajectory generator that uses inverse kinematics and forward kinematics 
            to maintain orientation as the robot moves.
          </p>
          <a href="#" class="project-link">Check it Out</a>
        </div>
        <div class="project-container project-card">
          <img
            src="assets/images/6DofRobotArm2.png"
            alt="netflic-clone"
            loading="lazy"
            class="project-pic"
          />
          <h3 class="project-title">6DOF Robot Arm Mechanical Design</h3>
          <p class="project-details">
            Hardware design, CAD design, 3D printing, and Arduino Schematics for a 6 DOF small desk robot.
            Useful for small repeatable tasks.
          </p>
          <a href="./RevynDesign.html"  class="project-link">Check it Out</a>
        </div>
        <div class="project-container project-card">
          <img
            src="assets/images/StayTuned2.png"
            alt="Check back for details later"
            loading="lazy"
            class="project-pic"
          />
          <h3 class="project-title">Hand Eye Calibration</h3>
          <p class="project-details">
            Stay Tuned. Project is currently in a planning phase/development phase.
            More details will be posted when the information is available.
          </p>
          <a href="#" class="project-link">Check it Out</a>
        </div>
      </div>
    </section>

    <!-- Social accounts - Fixed to the right -->
    <div class="socials">
      <a href="https://www.linkedin.com/in/brevinbanks" target="_blank"
        ><img
          src="assets/icons/icons8-linkedin.png"
          alt="Linkedin"
          title="Linkedin"
          loading="lazy"
          class="socicon"
      /></a>
      <a href="https://app.joinhandshake.com/stu/users/43200986" target="_blank"
        ><img
          src="assets/icons/icons8-handsharke.png"
          alt="Handshake"
          title="Handshake"
          loading="lazy"
          class="socicon"
      /></a>
      <a href="https://github.com/Brevinbanks" target="_blank"
        ><img
          src="assets/icons/icons8-smallgit.png"
          alt="Github"
          title="Github"
          loading="lazy"
          class="socicon"
      /></a>
    </div>

    <!-- Scroll to top -->
  
    <div id="back-to-top" class="back-to-top animate__animated animate__backOutDown">Back to Top</div>


    <!-- Website scripts -->
    <!-- This script controls the hamburger menu -->
    <script src="assets/js/app.js"></script>

    <!-- This script will hide the back to top button or show it -->
    <script type="text/javascript"
    src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js">
    </script>

    <script type="text/javascript" language="javascript">
      $(function () {
          var $win = $(window);

          $win.scroll(function () {
              if ($win.scrollTop() < 5){
                  document.getElementById("back-to-top").classList.remove('back-to-top:hover');
                  document.getElementById("back-to-top").classList.remove('animate__animated', 'animate__backInUp');
                  document.getElementById("back-to-top").classList.add('animate__animated', 'animate__backOutDown');
                }
                  else{
                  document.getElementById("back-to-top").classList.add('back-to-top:hover');
                  document.getElementById("back-to-top").classList.remove('animate__animated', 'animate__backOutDown');
                  document.getElementById("back-to-top").classList.add('animate__animated', 'animate__backInUp');
              }
              
            });
          
      });
    </script>

        <!-- Ion icons scripts -->
        <script
        type="module"
        src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"
      ></script>
      <script
        nomodule
        src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"
      ></script>

  </body>
</html>


<!-- Fix the hamburger menu so tapping away will hide it -->